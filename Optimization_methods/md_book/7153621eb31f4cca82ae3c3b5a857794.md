РГР 1 задача

# Задание №1
## I. Условие задачи

Для кормления животного ежедневно требуются витамины А, В
и С. Эти витамины содержатся в кормовых смесях двух видов.
Известно процентное содержание каждого витамина в каждой из
смесей, дневная норма витаминов и цена каждой смеси.
Определить наиболее дешёвый рацион, обеспечивающий норму.
При какой цене смеси 1 её будет невыгодно (выгодно) использовать
в рационе?

|		 | Смесь 1 	  | Смесь 2 | Смесь 3 |
|-	 	|--						|--|--|
|A	 	| -				 |0.1%|0.003 г.	|
|B	 	| 0.3%				|(3 — 4/24) * 0.1%|0.027 г.|
|C	 	| 0.1%				|(2 + 4/30) * 0.1%|(12 + 4/2) * 0,001 г.|
|Цена| 0.1 руб./г.| 0.015 * (3 + \|4-6\|) руб/г|.|

Посчитаем
|		 | Смесь 1 	  | Смесь 2 | Смесь 3 |
|-	 	|--						|--|--|
|A	 	| -				 |0.1%|0.003 г.	|
|B	 	| 0.3%				|0,28%|0.027 г.|
|C	 	| 0.1%				|0,21%|0.014 г.|
|Цена| 0.1 руб./г.| 0.075 руб./г.|.|

---
## II. Математическая постановка задачи
Обозначим  $x_1^*$, $x_2^*$ - вес оптимального количества корма 1 и 2
соответственно. Тогда нам надо решить следующую задачу
линейного программирования: найти минимум f при ограничениях (1)

$$ f = 0.1x_1 +0.075x_2 \rightarrow min$$

$$
\begin{align}
\left\{
\begin{aligned}
& 0,001x_1  \geqslant 0.003 \\
& 0,003x_1 + 0,0028x_2 \geqslant 0.027\\
& 0,001x_1 + 0,0021x_2 \geqslant 0.014
\end{aligned}
\right.
\end{align}
$$

Или: $min\{C^TX | AX \geqslant B, X \geqslant 0 \}$

$$
Где: \
C = \begin{pmatrix} 0.1   \\ 0.075 \end{pmatrix}; \

A = \begin{pmatrix} 0 & 0.001  \\ 0.003 & 0.0028  \\ 0.001 & 0.0021 \end{pmatrix}; \

B = \begin{pmatrix} 0.003  \\ 0.027 \\ 0.014 \end{pmatrix}; \

X = \begin{pmatrix} x_1   \\ x_2 \end{pmatrix}
$$


$$
\begin{cases}
x_2 \geqslant 3 \\
3x_1 + 2.8x_2 \geqslant 27 \\
x_1 + 2.1x_2 \geqslant 14
\end{cases}
$$

---
## III. Симплекс-метод

Зная, что $min(0.1x_1 +0.075x_2) = −max(0.1x_1 - 075x_2)$, будем искать $max$ функции $–f$.
Приведем задачу к каноническому виду, введя дополнительные
переменные $x_3, x_4, x_5$. При этом выберем эти переменные так, чтобы при их прибавлении к левым частям соотношений неравенства
превращались в равенства.

$$
\begin{cases}
x_2 - x_3 =3 \\
3x_1 + 2.8x_2 -x_4 = 27 \\
x_1 + 2.1x_2 - x_5 = 14 \\
x_i \geqslant 0, \ i = \bar{1.5}
\end{cases}
$$

Применим метод искусственного базиса. Для этого введем
переменные $y_1, y_2, y_3$

$$
\begin{cases}
x_2 - x_3 + y_1= 3 \\
3x_1 + 2.8x_2 -x_4 + y_2= 27 \\
x_1 + 2.1x_2 - x_5 + y_3 = 14 \\
x_i \geqslant 0, \ i = \bar{1.5} \\
y_j \geqslant 0; \ j = \bar{1.3}
\end{cases}
$$

Будем решать вспомогательную задачу
$W = y_1 + y_2 + y_3 \rightarrow min$

$y_1 = 3 - x_2 + x_3$
$y_2 = 27 - 3x_1 - 2.8x_2 + x_4$
$y_3 = 14 -x_1 -2.1x_2 + x_5$

$W = -4x_1 -5.9x_2 + x_3 + x_4 +x _5 + 44$

![ac2e60ef7058073803f4634fc61e2d51.png](:/1d3f8701e88648588d2c339c42d17c54)

Выбираем большую по модулю отрицательную $\Delta$. Видим, что при увеличении $x_2$ быстрее всего до нуля доходит $y_1$.
Меняем $y_1$ и $x_2$ местами.

$x_2 = x_3 - y_1+ 3$

$y_2 = - 3x_1 - 2.8(3 + x_3 - y_1) + x_4 + 27=\\= -3x_1 -2.8x_3 + x_4 + 2.8y_1+18.6$

$y_3 = - x_1 -2.1(3 + x_3 - y_1)+x_5 + 14=\\= -x_1 - 2.1x_3 + x_5 +2.1y_1 + 7.7$

$W = -4x_1 -5.9(3 + x_3 - y_1) + x_3 + x_4 + x_5 + 44=\\= -4x_1 - 4.9x_3 + x_4 +x_5 +5.9y_1 +26.3$

![80aed1c069f5756281dc6d917fa91cdc.png](:/3d04044b9d874951a7b41cc2ca049425)
Выбираем большую по модулю отрицательную $\Delta$. Видим, что при увеличении $x_3$ быстрее всего до нуля доходит $y_3$.
Меняем $y_3$ и $x_3$ местами.

$x_3 = -0.476x_1 + y_1 -0.476y_3 + 0.476x_5 + 3.667$

$x_2 = (-0.476x_1 + 0.476x_5 + y_1 -0.476y_3 + 3.667)- y_1 + 3=\\= -0.476x_1 + 0.476x_5 -0.476y_3 + 6.667$

$y_2 = -3x_1  +2.8y_1 - 2.8(-0.476x_1 + 0.476x_5 + y_1 -0.476y_3 + 3.667) + x_4 + 18.6=\\=-1.6672x_1-1.3328x_5+1.3328y_3+x_4+8.3324$

$W=-4x_1 + 5.9y_1 - 4.9(-0.476x_1 + 0.476x_5 + y_1 -0.476y_3 + 3.667) + x_4 + x_5 + 26.3=\\ = -1.6676x_1 + y_1 + 2.3324y_3 + x_4 -1.3324x_5 + 8.3317$

![4a74408e7c8ea0c03116c65074d8bec7.png](:/e2768d64c267429b9cfa61ac552ba3d6)
Выбираем большую по модулю отрицательную $\Delta$. Видим, что при
увеличении $x_1$ быстрее всего до нуля доходит $y_2$.
Меняем $y_2$ и $x_1$ местами.

$x_1 = -0.5998y_2 + 0.7994 y_3  + 0.5998x_4 - 0.7994x_5 + 4.9978$

$x_2 = -0.476(-0.5998y_2 + 0.7994 y_3  + 0.5998x_4 - 0.7994x_5 + 4.9978) - 0.476y_3 + 0.476x_5 + 6.667=\\=0.2855y_2 - 0.8565y_3 - 0.2855x_4 + 0.8565x_5 + 4.288$

$x_3 = -0.476(-0.5998y_2 + 0.7994 y_3  + 0.5998x_4 - 0.7994x_5 + 4.9978) + y_1 - 0.476y_3 + 0.476x_5 + 3.667=\\= y_1 + 0.2855y_2 - 0.8565y_3 - 0.2855x_4 + 0.8565x_5 + 1.288$

$W = -1.6676(-0.5998y_2 + 0.7994 y_3  + 0.5998x_4 - 0.7994x_5 + 4.9978) + y_1+ 2.3324y_3 + x_4 -1.3324x_5 + 8.3317=\\=1.0002y_2 + y_1 + 0.9993y_3 -0.0002x_4 + 0.0006x_5 - 0.0002$

![537f794d698e797e6364751d43306cfa.png](:/3fe1ace25997418fbfdf001c6c39b28e)
*(в строке W я округлил до целых, поскольку отклонение в десять-тысячных могут быть вызваны в следствие округлений выше)*

Видим, что выполнен критерий оптимальности: все $\Delta \geq 0$ .
Вспомогательная задача решена. Вернёмся теперь к исходной задаче.
Выбросим вспомогательные переменные $y_1, y_2, y_3$ , так как они нам
больше не понадобятся

$x_1 = 0,5998x_4 + 0.7994x_5 + 4.9978 \\ x_2=-0.2855x_4 + 0.8565x_5 + 4.288 \\ x_3 = -0.2855x_4 + 0.8565x_5 + 1.288$

$f = 0.1x_1 + 0.075x_2 = 0.1(0,5998x_4 + 0.7994x_5 + 4.9978) + 0.075(-0.2855x_4 + 0.8565x_5 + 4.288) =\\ =  0.0386x_4 + 0.1442x_5 +0.8214$

![3867b82fae370b5d58624347cfad4a64.png](:/fe0d6a9035f0464cb6a16f043a4d2ad4)

Обе характеристические разности отрицательные. Найдено
оптимальное решение.

$x_1^* = 4,9978 \\ x_2^*= 4,288\\ f^*= 0,8214 \approx 0.82$

---
## IV. Графический метод
$$ f = 0.1x_1 +0.075x_2 \rightarrow min$$

При следующих ограничения $х$:
$$
\begin{align}
\left\{
\begin{aligned}
&x_2 \geqslant 3 \\
&3x_1 + 2.8x_2 \geqslant 27 \\
&x_1 + 2.1x_2 \geqslant 14
\end{aligned}
\right.
\end{align}
$$

Построим область G, заданную системой неравенств (2) и
$graf = \begin{pmatrix} 0.1   \\ 0.075 \end{pmatrix}$

Удобно построить $\begin{pmatrix} 1   \\ 0.75 \end{pmatrix}$

![966f4d7586bb1e2ea846f51c35ca7e11.png](:/45e9f58272354af89a9a6f7045a8b050)

Движемся противоположно направлению градиента и определим
оптимальное решение. Оно расположено на пересечении
следующих прямых:

$$
\begin{cases}
&3x_1 + 2.8x_2 = 27 \\
&x_1 + 2.1x_2 = 14
\end{cases}
\qquad
\begin{cases}
&42 - 6.3x_2 + 2.8x_2 = 27 \\
&x_1 = 14 - 2.1x_2
\end{cases}
$$
$$
\begin{cases}
&3.5x_2 = 15 \\
&x_1 = 14 - 2.1x_2
\end{cases}
\qquad
\begin{cases}
&x_2 = 4.2857 \\
&x_1 = 5.0003
\end{cases}
$$

Следовательно 
$$
x_1^* = 5.0003 \\
x_2^* = 4.2857 \\
$$
$$
X^* = \begin{pmatrix} 5.0003   \\ 19,714 \end{pmatrix}
$$

Вычислим $f^*$
$f^* = 0.1x^*_1 + 0.075x^*_2 = 0.1*5.0003 + 0.075*4.2857 = 0.8214575 \approx 0.82$

---
## V. Решение двойственной задачи

Прямая задача:
$min\{C^TX | AX \geq B, X \geq 0\}$

$\begin{cases}
&x_2 \geq 0.003 \\
&x_1 \geq 0 \\
& 0.003x_1 + 0.0028x_2 \geq 0.027 \\
&x_1 + 0.0021x_2 \geq 0.014
\end{cases}$

и функционал $min\{0.1x_1 + 0.075x_2\}$

Двойственная задача:
$max\{B^T | A^T \lambda \leq C, \lambda \geq 0 \}$

$
A = \begin{pmatrix} 0 & 0.001  \\ 0.003 & 0.0028  \\ 0.001 & 0.0021 \end{pmatrix}; \
B = \begin{pmatrix} 0.003  \\ 0.027 \\ 0.014 \end{pmatrix}; \
C = \begin{pmatrix} 0.1   \\ 0.075 \end{pmatrix}; \\
$
\
$
A^T = \begin{pmatrix} 0 & 0.003 & 0.001 \\ 0.001 & 0.0028 & 0.0021 \end{pmatrix};
$

Двойственная задача имеет вид:
$max\{0,003\lambda_1 + 0,027\lambda_2 + 0,014\lambda_3\}$ при ограничениях:

$\begin{cases}
& 0.003 \lambda_2 + 0.001\lambda_3 \leq 0.1 \\
& 0.001\lambda_1 + 0.0028\lambda_2 + 0.0021\lambda_3  \leq 0.075 \\
& \lambda_i \geq 0, i = \bar{1.3}
\end{cases}$

\
***Решим двойственную задачу Симплекс-методом.***

Приведём к каноническому виду, введя дополнительные переменные $\lambda_4, \lambda_5$. При этом выберем эти переменные так, чтобы при их прибавлении к левым частям соотношений неравенства превращались в равенства.

$\begin{cases}
& 3 \lambda_2 + \lambda_3 + \lambda_4 = 100 \\
& \lambda_1 + 2.8\lambda_2 + 2.1\lambda_3 + \lambda_5  = 75
\end{cases}$

Построим симплекс-таблицу:
$\lambda_4 = -3\lambda_2 - \lambda_3 + 100 \\ \lambda_5 = -\lambda_1 - 2.8\lambda_2 - 2.1\lambda_3 + 75$

![a26447596a849165dd3139419096f557.png](:/0788db75195a4ee5a8ee3d97dd479024)

Выбираем наибольшую положительную $\Delta$. Видим, что при увеличении $\lambda_2$ быстрее всего до нуля дойдёт $\lambda_4$. Меняем $\lambda_2$ и $\lambda_4$ местами. 

$\lambda_2 =\frac{1}{3}(−\lambda_3 − \lambda_4 + 100) =\\= - 0,3333\lambda_3 − 0,3333\lambda_4 + 33,33$

$\lambda_5 = -\lambda_1 - 2.8( - 0,3333\lambda_3 − 0,3333\lambda_4 + 33,33) - 2.1\lambda_3 + 75 =\\= -\lambda_1 -1.6676\lambda_3 + 0.9332\lambda_4 - 18.234$

$f_д = 0.003\lambda_1 + 0.027( - 0,3333\lambda_3 − 0,3333\lambda_4 + 33,33) + 0.014\lambda_3 =\\= 0.003\lambda_1 + 0.005\lambda_3 - 0.0089\lambda_4 + 0.8999$

![5c5c7c5696e4f71fa28d84116c886e1e.png](:/95c2176f968b44dfafefc97094ba3103)

Выбираем наибольшую положительную $\Delta$. Видим, что при увеличении $\lambda_3$ быстрее всего до нуля дойдёт $\lambda_5$. Меняем $\lambda_3$ и $\lambda_5$ местами.

$\lambda_3 = \frac{1}{1.6676}(-\lambda_1 + 0.9332\lambda_4  - \lambda_5 - 18.234) =\\= -0.5997\lambda_1 + 0.5596\lambda_4 -0.5997\lambda_5  - 10.9343$

$\lambda_2 = -0.3333(-0.5997\lambda_1 + 0.5596\lambda_4 -0.5997\lambda_5  - 10.9343) - 0.3333\lambda_4 + 33.33 =\\= 0.1999 \lambda_1 - 0.5198\lambda_4 + 0.1999 \lambda_5 + 36.9745$

$f_д = 0.003\lambda_1 + 0.005(-0.5997\lambda_1 + 0.5596\lambda_4 -0.5997\lambda_5  - 10.9343) - 0.0089\lambda_4 + 0.8999 \\= 0.0000015 \lambda_1 - 0.0061\lambda_4 -0.003\lambda_5+ 0.8452$

![7aa6bc49e47b2d2dbc0b03f8d14bcec5.png](:/90c57c37ad744681b90953222ce04dda)

Видим, что выполнен критерий оптимальности: все $\Delta \leq 0$.

id: 7153621eb31f4cca82ae3c3b5a857794
parent_id: 242a24023cbf4044be8bbe6c0c38f6db
created_time: 2024-05-22T00:12:29.326Z
updated_time: 2024-07-22T14:12:27.891Z
is_conflict: 0
latitude: 59.93428020
longitude: 30.33509860
altitude: 0.0000
author: 
source_url: 
is_todo: 0
todo_due: 0
todo_completed: 0
source: joplin-desktop
source_application: net.cozic.joplin-desktop
application_data: 
order: 0
user_created_time: 2024-05-22T00:12:29.326Z
user_updated_time: 2024-07-22T14:12:27.891Z
encryption_cipher_text: 
encryption_applied: 0
markup_language: 1
is_shared: 0
share_id: 
conflict_original_id: 
master_key_id: 
user_data: 
deleted_time: 0
type_: 1